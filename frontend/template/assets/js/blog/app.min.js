/*
Template Name: Color Admin - Responsive Admin Dashboard Template build with Bootstrap 5
Version: 5.3.2
Author: Sean Ngu
Website: http://www.seantheme.com/color-admin/
	----------------------------
		APPS CONTENT TABLE
	----------------------------

	<!-- ======== GLOBAL SCRIPT SETTING ======== -->
	01. Handle Fixed Header Option
	02. Handle Tooltip & Popover Activation
	03. Handle Theme Panel Expand
	04. Handle Theme Page Control
	05. Handle Payment Type Selection
	06. Handle Checkout Qty Control
	07. Handle Product Image
	08. Handle Paroller
	09. Handle Check Bootstrap Version
	10. Handle Get Css Variable

	<!-- ======== APPLICATION SETTING ======== -->
	Application Controller
*/

var app = {
	id: '#app',
	class: 'app',
	isMobile: ((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) || window.innerWidth < 767),
	darkMode: {
		attr: 'data-bs-theme',
		value: 'dark',
		eventName: 'theme-reload'
	},
	themePanel: {
		class: 'theme-panel',
		toggleAttr: 'data-toggle="theme-panel-expand"',
		cookieName: 'theme-panel-expand',
		activeClass: 'active',
		themeListCLass: 'theme-list',
		themeListItemCLass: 'theme-list-item',
		theme: {
			toggleAttr: 'data-toggle="theme-selector"',
			cookieName: 'app-theme',
			activeClass: 'active',
			classAttr: 'data-theme-class'
		},
		themeDarkMode: {
			class: 'dark-mode',
			toggleAttr: 'name="app-theme-dark-mode"',
			cookieName: 'app-theme-dark-mode'
		},
	},
	font: {},
	color: {},
	variablePrefix: 'bs-',
	variableFontList: ['body-font-family', 'body-font-size', 'body-font-weight', 'body-line-height'],
	variableColorList: [
		'theme', 'theme-rgb', 'theme-color', 'theme-color-rgb',
		'component-color', 'component-color-rgb', 'component-bg', 'component-bg-rgb',
		'component-secondary-bg', 'component-bg-rgb', 'component-tertiary-bg', 'component-tertiary-bg-rgb',
		'default', 'default-rgb',
		'primary', 'primary-rgb', 'primary-bg-subtle', 'primary-text', 'primary-border-subtle',
		'secondary', 'secondary-rgb', 'secondary-bg-subtle', 'secondary-text', 'secondary-border-subtle',
		'success', 'success-rgb', 'success-bg-subtle', 'success-text', 'success-border-subtle',
		'warning', 'warning-rgb', 'warning-bg-subtle', 'warning-text', 'warning-border-subtle',
		'info', 'info-rgb', 'info-bg-subtle', 'info-text', 'info-border-subtle',
		'danger', 'danger-rgb', 'danger-bg-subtle', 'danger-text', 'danger-border-subtle',
		'light', 'light-rgb', 'light-bg-subtle', 'light-text', 'light-border-subtle',
		'dark', 'dark-rgb', 'dark-bg-subtle', 'dark-text', 'dark-border-subtle',
		'black', 'black-rgb',
		'blue', 'blue-rgb', 
		'inverse', 'inverse-rgb',
		'white', 'white-rgb',
		'red', 'red-rgb', 
		'teal', 'teal-rgb',
		'indigo', 'indigo-rgb', 
		'orange', 'orange-rgb', 
		'purple', 'purple-rgb',
		'yellow', 'yellow-rgb',
		'green', 'green-rgb',
		'pink', 'pink-rgb',
		'cyan', 'cyan-rgb',
		'gray', 'gray-rgb',
		'lime', 'lime-rgb',
		'gray-100', 'gray-200', 'gray-300', 'gray-400', 'gray-500',  'gray-600', 'gray-700', 'gray-800', 'gray-900', 
		'gray-100-rgb', 'gray-200-rgb', 'gray-300-rgb', 'gray-400-rgb', 'gray-500-rgb',  'gray-600-rgb', 'gray-700-rgb', 'gray-800-rgb', 'gray-900-rgb', 
		'muted', 'muted-rgb', 'emphasis-color', 'emphasis-color-rgb',
		'heading-color', 
		'body-bg', 'body-bg-rgb', 'body-color', 'body-color-rgb',
		'secondary-color', 'secondary-color-rgb', 'secondary-bg', 'secondary-bg-rgb',
		'tertiary-color', 'tertiary-color-rgb', 'tertiary-bg', 'tertiary-bg-rgb',
		'link-color', 'link-color-rgb', 'link-hover-color', 'link-hover-color-rgb', 
		'border-color', 'border-color-translucent'
	],
	breakpoints: {
		xs: 0,
		sm: 576,
		md: 768,
		lg: 992,
		xl: 1200,
		xxl: 1400,
		xxxl: 1800
	}
}

var slideUp = function(elm, duration = app.animation.speed) {
	if (!elm.classList.contains('transitioning')) {
		elm.classList.add('transitioning');
		elm.style.transitionProperty = 'height, margin, padding';
		elm.style.transitionDuration = duration + 'ms';
		elm.style.boxSizing = 'border-box';
		elm.style.height = elm.offsetHeight + 'px';
		elm.offsetHeight;
		elm.style.overflow = 'hidden';
		elm.style.height = 0;
		elm.style.paddingTop = 0;
		elm.style.paddingBottom = 0;
		elm.style.marginTop = 0;
		elm.style.marginBottom = 0;
		window.setTimeout( () => {
			elm.style.display = 'none';
			elm.style.removeProperty('height');
			elm.style.removeProperty('padding-top');
			elm.style.removeProperty('padding-bottom');
			elm.style.removeProperty('margin-top');
			elm.style.removeProperty('margin-bottom');
			elm.style.removeProperty('overflow');
			elm.style.removeProperty('transition-duration');
			elm.style.removeProperty('transition-property');
			elm.classList.remove('transitioning');
		}, duration);
	}
};

var slideDown = function(elm, duration = app.animation.speed) {
	if (!elm.classList.contains('transitioning')) {
		elm.classList.add('transitioning');
		elm.style.removeProperty('display');
		let display = window.getComputedStyle(elm).display;
		if (display === 'none') display = 'block';
		elm.style.display = display;
		let height = elm.offsetHeight;
		elm.style.overflow = 'hidden';
		elm.style.height = 0;
		elm.style.paddingTop = 0;
		elm.style.paddingBottom = 0;
		elm.style.marginTop = 0;
		elm.style.marginBottom = 0;
		elm.offsetHeight;
		elm.style.boxSizing = 'border-box';
		elm.style.transitionProperty = "height, margin, padding";
		elm.style.transitionDuration = duration + 'ms';
		elm.style.height = height + 'px';
		elm.style.removeProperty('padding-top');
		elm.style.removeProperty('padding-bottom');
		elm.style.removeProperty('margin-top');
		elm.style.removeProperty('margin-bottom');
		window.setTimeout( () => {
			elm.style.removeProperty('height');
			elm.style.removeProperty('overflow');
			elm.style.removeProperty('transition-duration');
			elm.style.removeProperty('transition-property');
			elm.classList.remove('transitioning');
		}, duration);
	}
};

var slideToggle = function(elm, duration = app.animation.speed) {
	if (window.getComputedStyle(elm).display === 'none') {
		return slideDown(elm, duration);
	} else {
		return slideUp(elm, duration);
	}
};

var setCookie = function(cookieName, cookieValue) {
	var now = new Date();
  var time = now.getTime();
  var expireTime = time + 1000*36000;
  now.setTime(expireTime);
  document.cookie = cookieName + '='+ cookieValue +';expires='+now.toUTCString()+';path=/';
};

var getCookie = function(cookieName) {
  let name = cookieName + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
};



/* 01. Handle Fixed Header Option
------------------------------------------------ */
var handleHeaderFixedTop = function() {
	if ($('#header[data-fixed-top="true"]').length !== 0) {
		var targetScrollTop = $('#top-nav').height();
		var targetPaddingTop = $('#header').height();
		$(window).on('scroll', function() {
			if ($(window).scrollTop() >= targetScrollTop) {
				$('body').css('padding-top', targetPaddingTop);
				$('#header').addClass('header-fixed');
			} else {
				$('#header').removeClass('header-fixed');
				$('body').css('padding-top', '0');
			}
		});
	}
};


/* 02. Handle Tooltip & Popover Activation
------------------------------------------------ */
var handleTooltipPopoverActivation = function() {
	if ($('[data-bs-toggle=tooltip]').length !== 0) {
		$('[data-bs-toggle=tooltip]').tooltip();
	}
	if ($('[data-bs-toggle=popover]').length !== 0) {
		$('[data-bs-toggle=popover]').popover();
	}
};


/* 04. Handle Theme Panel
------------------------------------------------ */
var handleThemePanel = function() {
	// Theme Panel - Toggle / Dismiss
	var elm = document.querySelector('['+ app.themePanel.toggleAttr +']');
	if (elm) {
		elm.onclick = function(e) {
			e.preventDefault();
			var target = document.querySelector('.'+ app.themePanel.class);
			var targetExpand = (target.classList.contains(app.themePanel.activeClass)) ? false : true;
			
			target.classList.toggle(app.themePanel.activeClass);
			setCookie(app.themePanel.cookieName, targetExpand);
		}
	}
	
	// Theme Panel - Theme Selector
	var elms = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']'));
	if (elms) {
		elms.map(function(elm) {
			elm.onclick = function() {
				var targetThemeClass = this.getAttribute(app.themePanel.theme.classAttr);
				for (var x = 0; x < document.body.classList.length; x++) {
					var targetClass = document.body.classList[x];
					if (targetClass.search('theme-') > -1) {
						document.body.classList.remove(targetClass);
					}
				}
				if (targetThemeClass) {
					document.body.classList.add(targetThemeClass);
				}
			
				var togglers = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']'));
				togglers.map(function(toggler) {
					if (toggler != elm) {
						toggler.closest('.'+ app.themePanel.themeListItemCLass).classList.remove(app.themePanel.theme.activeClass);
					} else {
						toggler.closest('.'+ app.themePanel.themeListItemCLass).classList.add(app.themePanel.theme.activeClass);
					}
				});
				setCookie(app.themePanel.theme.cookieName, targetThemeClass);
			}
		});
	}
	
	
	// Theme Panel - Dark Mode
	var elms = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.themeDarkMode.toggleAttr +']'));
	elms.map(function(elm) {
		elm.onchange = function() {
			if (this.checked) {
				document.querySelector('html').setAttribute(app.darkMode.attr, app.darkMode.value);
			} else {
				document.querySelector('html').removeAttribute(app.darkMode.attr);
			}
			App.initVariable();
			setCookie(app.themePanel.themeDarkMode.cookieName, (this.checked) ? app.themePanel.themeDarkMode.class : '');
			document.dispatchEvent(new CustomEvent(app.darkMode.eventName));
		}
	});
	
	
	if (getCookie(app.themePanel.cookieName) && getCookie(app.themePanel.cookieName) == 'true') {
		var elm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.toggleAttr +']');
		if (elm) {
			elm.click();
		}
	}
	if (getCookie(app.themePanel.theme.cookieName)) {
		var elm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']['+ app.themePanel.theme.classAttr +'="'+ getCookie(app.themePanel.theme.cookieName) +'"]');
		if (elm) {
			elm.click();
		}
	}
	if (getCookie(app.themePanel.themeDarkMode.cookieName)) {
		var elm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.themeDarkMode.toggleAttr +']');
		if (elm) {
			elm.checked = true;
			elm.onchange();
		}
	}
};


/* 05. Handle Payment Type Selection
------------------------------------------------ */
var handlePaymentTypeSelection = function() {
	$(document).on('click', '[data-click="set-payment"]', function(e) {
		e.preventDefault();
		var targetLi = $(this).closest('li');
		var targetValue = $(this).attr('data-value');
		
		$('[data-click="set-payment"]').closest('li').not(targetLi).removeClass('active');
		$('[data-id="payment-type"]').val(targetValue);
		$(targetLi).addClass('active');
	});
};


/* 06. Handle Checkout Qty Control
------------------------------------------------ */
var handleQtyControl = function() {
	$(document).on('click', '[data-click="increase-qty"]', function(e) {
		e.preventDefault();
		var targetInput = $(this).attr('data-target');
		var targetValue = parseInt($(targetInput).val()) + 1;  
		
		$(targetInput).val(targetValue);
	});
	$('[data-click="decrease-qty"]').click(function(e) {
		e.preventDefault();
		var targetInput = $(this).attr('data-target');
		var targetValue = parseInt($(targetInput).val()) - 1;  
		    targetValue = (targetValue < 0) ? 0 : targetValue;
		
		$(targetInput).val(targetValue);
	});
};


/* 07. Handle Product Image
------------------------------------------------ */
var handleProductImage = function() {
	$(document).on('click', '[data-click="show-main-image"]', function(e) {
		e.preventDefault();

		var targetContainer = '[data-id="main-image"]';
		var targetImage = '<img src="'+ $(this).attr('data-url') +'" />';
		var targetLi = $(this).closest('li');

		$(targetContainer).html(targetImage);
		$(targetLi).addClass('active');
		$('[data-click="show-main-image"]').closest('li').not(targetLi).removeClass('active');
	});
};


/* 08. Handle Paroller
------------------------------------------------ */
var handleParoller = function() {
	if (typeof $.fn.paroller !== 'undefined') {
		if ($('[data-paroller="true"]').length !== 0) {
			$('[data-paroller="true"]').paroller();
		}
	}
};


/* 09. Handle Check Bootstrap Version
------------------------------------------------ */
var handleCheckBootstrapVersion = function() {
	return parseInt($.fn.tooltip.Constructor.VERSION);
};


/* 10. Handle Get Css Variable
------------------------------------------------ */
var handleCssVariable = function() {
	var rootStyle = getComputedStyle(document.body);
	
	// font
	if (app.variableFontList && app.variablePrefix) {
		for (var i = 0; i < (app.variableFontList).length; i++) {
			app.font[app.variableFontList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableFontList[i]).trim();
		}
	}
	
	// color
	if (app.variableColorList && app.variablePrefix) {
		for (var i = 0; i < (app.variableColorList).length; i++) {
			app.color[app.variableColorList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableColorList[i]).trim();
		}
	}
};


/* Application Controller
------------------------------------------------ */
var App = function () {
	"use strict";
	
	return {
		//main function
		init: function () {
			handleHeaderFixedTop();
			handleTooltipPopoverActivation();
			handleThemePanel();
			handlePaymentTypeSelection();
			handleQtyControl();
			handleProductImage();
			handleParoller();
			
			this.initVariable();
		},
		initVariable: function() {
			handleCssVariable();
		}
	};
}();

$(document).ready(function() {
	App.init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuVGVtcGxhdGUgTmFtZTogQ29sb3IgQWRtaW4gLSBSZXNwb25zaXZlIEFkbWluIERhc2hib2FyZCBUZW1wbGF0ZSBidWlsZCB3aXRoIEJvb3RzdHJhcCA1XHJcblZlcnNpb246IDUuMy4xXHJcbkF1dGhvcjogU2VhbiBOZ3VcclxuV2Vic2l0ZTogaHR0cDovL3d3dy5zZWFudGhlbWUuY29tL2NvbG9yLWFkbWluL1xyXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdEFQUFMgQ09OVEVOVCBUQUJMRVxyXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcblx0PCEtLSA9PT09PT09PSBHTE9CQUwgU0NSSVBUIFNFVFRJTkcgPT09PT09PT0gLS0+XHJcblx0MDEuIEhhbmRsZSBGaXhlZCBIZWFkZXIgT3B0aW9uXHJcblx0MDIuIEhhbmRsZSBUb29sdGlwICYgUG9wb3ZlciBBY3RpdmF0aW9uXHJcblx0MDMuIEhhbmRsZSBUaGVtZSBQYW5lbCBFeHBhbmRcclxuXHQwNC4gSGFuZGxlIFRoZW1lIFBhZ2UgQ29udHJvbFxyXG5cdDA1LiBIYW5kbGUgUGF5bWVudCBUeXBlIFNlbGVjdGlvblxyXG5cdDA2LiBIYW5kbGUgQ2hlY2tvdXQgUXR5IENvbnRyb2xcclxuXHQwNy4gSGFuZGxlIFByb2R1Y3QgSW1hZ2VcclxuXHQwOC4gSGFuZGxlIFBhcm9sbGVyXHJcblx0MDkuIEhhbmRsZSBDaGVjayBCb290c3RyYXAgVmVyc2lvblxyXG5cdDEwLiBIYW5kbGUgR2V0IENzcyBWYXJpYWJsZVxyXG5cclxuXHQ8IS0tID09PT09PT09IEFQUExJQ0FUSU9OIFNFVFRJTkcgPT09PT09PT0gLS0+XHJcblx0QXBwbGljYXRpb24gQ29udHJvbGxlclxyXG4qL1xyXG5cclxudmFyIGFwcCA9IHtcclxuXHRpZDogJyNhcHAnLFxyXG5cdGNsYXNzOiAnYXBwJyxcclxuXHRpc01vYmlsZTogKCgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHx8IHdpbmRvdy5pbm5lcldpZHRoIDwgNzY3KSxcclxuXHRkYXJrTW9kZToge1xyXG5cdFx0YXR0cjogJ2RhdGEtYnMtdGhlbWUnLFxyXG5cdFx0dmFsdWU6ICdkYXJrJyxcclxuXHRcdGV2ZW50TmFtZTogJ3RoZW1lLXJlbG9hZCdcclxuXHR9LFxyXG5cdHRoZW1lUGFuZWw6IHtcclxuXHRcdGNsYXNzOiAndGhlbWUtcGFuZWwnLFxyXG5cdFx0dG9nZ2xlQXR0cjogJ2RhdGEtdG9nZ2xlPVwidGhlbWUtcGFuZWwtZXhwYW5kXCInLFxyXG5cdFx0Y29va2llTmFtZTogJ3RoZW1lLXBhbmVsLWV4cGFuZCcsXHJcblx0XHRhY3RpdmVDbGFzczogJ2FjdGl2ZScsXHJcblx0XHR0aGVtZUxpc3RDTGFzczogJ3RoZW1lLWxpc3QnLFxyXG5cdFx0dGhlbWVMaXN0SXRlbUNMYXNzOiAndGhlbWUtbGlzdC1pdGVtJyxcclxuXHRcdHRoZW1lOiB7XHJcblx0XHRcdHRvZ2dsZUF0dHI6ICdkYXRhLXRvZ2dsZT1cInRoZW1lLXNlbGVjdG9yXCInLFxyXG5cdFx0XHRjb29raWVOYW1lOiAnYXBwLXRoZW1lJyxcclxuXHRcdFx0YWN0aXZlQ2xhc3M6ICdhY3RpdmUnLFxyXG5cdFx0XHRjbGFzc0F0dHI6ICdkYXRhLXRoZW1lLWNsYXNzJ1xyXG5cdFx0fSxcclxuXHRcdHRoZW1lRGFya01vZGU6IHtcclxuXHRcdFx0Y2xhc3M6ICdkYXJrLW1vZGUnLFxyXG5cdFx0XHR0b2dnbGVBdHRyOiAnbmFtZT1cImFwcC10aGVtZS1kYXJrLW1vZGVcIicsXHJcblx0XHRcdGNvb2tpZU5hbWU6ICdhcHAtdGhlbWUtZGFyay1tb2RlJ1xyXG5cdFx0fSxcclxuXHR9LFxyXG5cdGZvbnQ6IHt9LFxyXG5cdGNvbG9yOiB7fSxcclxuXHR2YXJpYWJsZVByZWZpeDogJ2JzLScsXHJcblx0dmFyaWFibGVGb250TGlzdDogWydib2R5LWZvbnQtZmFtaWx5JywgJ2JvZHktZm9udC1zaXplJywgJ2JvZHktZm9udC13ZWlnaHQnLCAnYm9keS1saW5lLWhlaWdodCddLFxyXG5cdHZhcmlhYmxlQ29sb3JMaXN0OiBbXHJcblx0XHQndGhlbWUnLCAndGhlbWUtcmdiJywgJ3RoZW1lLWNvbG9yJywgJ3RoZW1lLWNvbG9yLXJnYicsXHJcblx0XHQnY29tcG9uZW50LWNvbG9yJywgJ2NvbXBvbmVudC1jb2xvci1yZ2InLCAnY29tcG9uZW50LWJnJywgJ2NvbXBvbmVudC1iZy1yZ2InLFxyXG5cdFx0J2NvbXBvbmVudC1zZWNvbmRhcnktYmcnLCAnY29tcG9uZW50LWJnLXJnYicsICdjb21wb25lbnQtdGVydGlhcnktYmcnLCAnY29tcG9uZW50LXRlcnRpYXJ5LWJnLXJnYicsXHJcblx0XHQnZGVmYXVsdCcsICdkZWZhdWx0LXJnYicsXHJcblx0XHQncHJpbWFyeScsICdwcmltYXJ5LXJnYicsICdwcmltYXJ5LWJnLXN1YnRsZScsICdwcmltYXJ5LXRleHQnLCAncHJpbWFyeS1ib3JkZXItc3VidGxlJyxcclxuXHRcdCdzZWNvbmRhcnknLCAnc2Vjb25kYXJ5LXJnYicsICdzZWNvbmRhcnktYmctc3VidGxlJywgJ3NlY29uZGFyeS10ZXh0JywgJ3NlY29uZGFyeS1ib3JkZXItc3VidGxlJyxcclxuXHRcdCdzdWNjZXNzJywgJ3N1Y2Nlc3MtcmdiJywgJ3N1Y2Nlc3MtYmctc3VidGxlJywgJ3N1Y2Nlc3MtdGV4dCcsICdzdWNjZXNzLWJvcmRlci1zdWJ0bGUnLFxyXG5cdFx0J3dhcm5pbmcnLCAnd2FybmluZy1yZ2InLCAnd2FybmluZy1iZy1zdWJ0bGUnLCAnd2FybmluZy10ZXh0JywgJ3dhcm5pbmctYm9yZGVyLXN1YnRsZScsXHJcblx0XHQnaW5mbycsICdpbmZvLXJnYicsICdpbmZvLWJnLXN1YnRsZScsICdpbmZvLXRleHQnLCAnaW5mby1ib3JkZXItc3VidGxlJyxcclxuXHRcdCdkYW5nZXInLCAnZGFuZ2VyLXJnYicsICdkYW5nZXItYmctc3VidGxlJywgJ2Rhbmdlci10ZXh0JywgJ2Rhbmdlci1ib3JkZXItc3VidGxlJyxcclxuXHRcdCdsaWdodCcsICdsaWdodC1yZ2InLCAnbGlnaHQtYmctc3VidGxlJywgJ2xpZ2h0LXRleHQnLCAnbGlnaHQtYm9yZGVyLXN1YnRsZScsXHJcblx0XHQnZGFyaycsICdkYXJrLXJnYicsICdkYXJrLWJnLXN1YnRsZScsICdkYXJrLXRleHQnLCAnZGFyay1ib3JkZXItc3VidGxlJyxcclxuXHRcdCdibGFjaycsICdibGFjay1yZ2InLFxyXG5cdFx0J2JsdWUnLCAnYmx1ZS1yZ2InLCBcclxuXHRcdCdpbnZlcnNlJywgJ2ludmVyc2UtcmdiJyxcclxuXHRcdCd3aGl0ZScsICd3aGl0ZS1yZ2InLFxyXG5cdFx0J3JlZCcsICdyZWQtcmdiJywgXHJcblx0XHQndGVhbCcsICd0ZWFsLXJnYicsXHJcblx0XHQnaW5kaWdvJywgJ2luZGlnby1yZ2InLCBcclxuXHRcdCdvcmFuZ2UnLCAnb3JhbmdlLXJnYicsIFxyXG5cdFx0J3B1cnBsZScsICdwdXJwbGUtcmdiJyxcclxuXHRcdCd5ZWxsb3cnLCAneWVsbG93LXJnYicsXHJcblx0XHQnZ3JlZW4nLCAnZ3JlZW4tcmdiJyxcclxuXHRcdCdwaW5rJywgJ3BpbmstcmdiJyxcclxuXHRcdCdjeWFuJywgJ2N5YW4tcmdiJyxcclxuXHRcdCdncmF5JywgJ2dyYXktcmdiJyxcclxuXHRcdCdsaW1lJywgJ2xpbWUtcmdiJyxcclxuXHRcdCdncmF5LTEwMCcsICdncmF5LTIwMCcsICdncmF5LTMwMCcsICdncmF5LTQwMCcsICdncmF5LTUwMCcsICAnZ3JheS02MDAnLCAnZ3JheS03MDAnLCAnZ3JheS04MDAnLCAnZ3JheS05MDAnLCBcclxuXHRcdCdncmF5LTEwMC1yZ2InLCAnZ3JheS0yMDAtcmdiJywgJ2dyYXktMzAwLXJnYicsICdncmF5LTQwMC1yZ2InLCAnZ3JheS01MDAtcmdiJywgICdncmF5LTYwMC1yZ2InLCAnZ3JheS03MDAtcmdiJywgJ2dyYXktODAwLXJnYicsICdncmF5LTkwMC1yZ2InLCBcclxuXHRcdCdtdXRlZCcsICdtdXRlZC1yZ2InLCAnZW1waGFzaXMtY29sb3InLCAnZW1waGFzaXMtY29sb3ItcmdiJyxcclxuXHRcdCdoZWFkaW5nLWNvbG9yJywgXHJcblx0XHQnYm9keS1iZycsICdib2R5LWJnLXJnYicsICdib2R5LWNvbG9yJywgJ2JvZHktY29sb3ItcmdiJyxcclxuXHRcdCdzZWNvbmRhcnktY29sb3InLCAnc2Vjb25kYXJ5LWNvbG9yLXJnYicsICdzZWNvbmRhcnktYmcnLCAnc2Vjb25kYXJ5LWJnLXJnYicsXHJcblx0XHQndGVydGlhcnktY29sb3InLCAndGVydGlhcnktY29sb3ItcmdiJywgJ3RlcnRpYXJ5LWJnJywgJ3RlcnRpYXJ5LWJnLXJnYicsXHJcblx0XHQnbGluay1jb2xvcicsICdsaW5rLWNvbG9yLXJnYicsICdsaW5rLWhvdmVyLWNvbG9yJywgJ2xpbmstaG92ZXItY29sb3ItcmdiJywgXHJcblx0XHQnYm9yZGVyLWNvbG9yJywgJ2JvcmRlci1jb2xvci10cmFuc2x1Y2VudCdcclxuXHRdLFxyXG5cdGJyZWFrcG9pbnRzOiB7XHJcblx0XHR4czogMCxcclxuXHRcdHNtOiA1NzYsXHJcblx0XHRtZDogNzY4LFxyXG5cdFx0bGc6IDk5MixcclxuXHRcdHhsOiAxMjAwLFxyXG5cdFx0eHhsOiAxNDAwLFxyXG5cdFx0eHh4bDogMTgwMFxyXG5cdH1cclxufVxyXG5cclxudmFyIHNsaWRlVXAgPSBmdW5jdGlvbihlbG0sIGR1cmF0aW9uID0gYXBwLmFuaW1hdGlvbi5zcGVlZCkge1xyXG5cdGlmICghZWxtLmNsYXNzTGlzdC5jb250YWlucygndHJhbnNpdGlvbmluZycpKSB7XHJcblx0XHRlbG0uY2xhc3NMaXN0LmFkZCgndHJhbnNpdGlvbmluZycpO1xyXG5cdFx0ZWxtLnN0eWxlLnRyYW5zaXRpb25Qcm9wZXJ0eSA9ICdoZWlnaHQsIG1hcmdpbiwgcGFkZGluZyc7XHJcblx0XHRlbG0uc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uID0gZHVyYXRpb24gKyAnbXMnO1xyXG5cdFx0ZWxtLnN0eWxlLmJveFNpemluZyA9ICdib3JkZXItYm94JztcclxuXHRcdGVsbS5zdHlsZS5oZWlnaHQgPSBlbG0ub2Zmc2V0SGVpZ2h0ICsgJ3B4JztcclxuXHRcdGVsbS5vZmZzZXRIZWlnaHQ7XHJcblx0XHRlbG0uc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuXHRcdGVsbS5zdHlsZS5oZWlnaHQgPSAwO1xyXG5cdFx0ZWxtLnN0eWxlLnBhZGRpbmdUb3AgPSAwO1xyXG5cdFx0ZWxtLnN0eWxlLnBhZGRpbmdCb3R0b20gPSAwO1xyXG5cdFx0ZWxtLnN0eWxlLm1hcmdpblRvcCA9IDA7XHJcblx0XHRlbG0uc3R5bGUubWFyZ2luQm90dG9tID0gMDtcclxuXHRcdHdpbmRvdy5zZXRUaW1lb3V0KCAoKSA9PiB7XHJcblx0XHRcdGVsbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2hlaWdodCcpO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3BhZGRpbmctdG9wJyk7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgncGFkZGluZy1ib3R0b20nKTtcclxuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdtYXJnaW4tdG9wJyk7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnbWFyZ2luLWJvdHRvbScpO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ292ZXJmbG93Jyk7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgndHJhbnNpdGlvbi1kdXJhdGlvbicpO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3RyYW5zaXRpb24tcHJvcGVydHknKTtcclxuXHRcdFx0ZWxtLmNsYXNzTGlzdC5yZW1vdmUoJ3RyYW5zaXRpb25pbmcnKTtcclxuXHRcdH0sIGR1cmF0aW9uKTtcclxuXHR9XHJcbn07XHJcblxyXG52YXIgc2xpZGVEb3duID0gZnVuY3Rpb24oZWxtLCBkdXJhdGlvbiA9IGFwcC5hbmltYXRpb24uc3BlZWQpIHtcclxuXHRpZiAoIWVsbS5jbGFzc0xpc3QuY29udGFpbnMoJ3RyYW5zaXRpb25pbmcnKSkge1xyXG5cdFx0ZWxtLmNsYXNzTGlzdC5hZGQoJ3RyYW5zaXRpb25pbmcnKTtcclxuXHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnZGlzcGxheScpO1xyXG5cdFx0bGV0IGRpc3BsYXkgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbG0pLmRpc3BsYXk7XHJcblx0XHRpZiAoZGlzcGxheSA9PT0gJ25vbmUnKSBkaXNwbGF5ID0gJ2Jsb2NrJztcclxuXHRcdGVsbS5zdHlsZS5kaXNwbGF5ID0gZGlzcGxheTtcclxuXHRcdGxldCBoZWlnaHQgPSBlbG0ub2Zmc2V0SGVpZ2h0O1xyXG5cdFx0ZWxtLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XHJcblx0XHRlbG0uc3R5bGUuaGVpZ2h0ID0gMDtcclxuXHRcdGVsbS5zdHlsZS5wYWRkaW5nVG9wID0gMDtcclxuXHRcdGVsbS5zdHlsZS5wYWRkaW5nQm90dG9tID0gMDtcclxuXHRcdGVsbS5zdHlsZS5tYXJnaW5Ub3AgPSAwO1xyXG5cdFx0ZWxtLnN0eWxlLm1hcmdpbkJvdHRvbSA9IDA7XHJcblx0XHRlbG0ub2Zmc2V0SGVpZ2h0O1xyXG5cdFx0ZWxtLnN0eWxlLmJveFNpemluZyA9ICdib3JkZXItYm94JztcclxuXHRcdGVsbS5zdHlsZS50cmFuc2l0aW9uUHJvcGVydHkgPSBcImhlaWdodCwgbWFyZ2luLCBwYWRkaW5nXCI7XHJcblx0XHRlbG0uc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uID0gZHVyYXRpb24gKyAnbXMnO1xyXG5cdFx0ZWxtLnN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XHJcblx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3BhZGRpbmctdG9wJyk7XHJcblx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3BhZGRpbmctYm90dG9tJyk7XHJcblx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ21hcmdpbi10b3AnKTtcclxuXHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnbWFyZ2luLWJvdHRvbScpO1xyXG5cdFx0d2luZG93LnNldFRpbWVvdXQoICgpID0+IHtcclxuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdoZWlnaHQnKTtcclxuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdvdmVyZmxvdycpO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3RyYW5zaXRpb24tZHVyYXRpb24nKTtcclxuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCd0cmFuc2l0aW9uLXByb3BlcnR5Jyk7XHJcblx0XHRcdGVsbS5jbGFzc0xpc3QucmVtb3ZlKCd0cmFuc2l0aW9uaW5nJyk7XHJcblx0XHR9LCBkdXJhdGlvbik7XHJcblx0fVxyXG59O1xyXG5cclxudmFyIHNsaWRlVG9nZ2xlID0gZnVuY3Rpb24oZWxtLCBkdXJhdGlvbiA9IGFwcC5hbmltYXRpb24uc3BlZWQpIHtcclxuXHRpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxtKS5kaXNwbGF5ID09PSAnbm9uZScpIHtcclxuXHRcdHJldHVybiBzbGlkZURvd24oZWxtLCBkdXJhdGlvbik7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybiBzbGlkZVVwKGVsbSwgZHVyYXRpb24pO1xyXG5cdH1cclxufTtcclxuXHJcbnZhciBzZXRDb29raWUgPSBmdW5jdGlvbihjb29raWVOYW1lLCBjb29raWVWYWx1ZSkge1xyXG5cdHZhciBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gIHZhciB0aW1lID0gbm93LmdldFRpbWUoKTtcclxuICB2YXIgZXhwaXJlVGltZSA9IHRpbWUgKyAxMDAwKjM2MDAwO1xyXG4gIG5vdy5zZXRUaW1lKGV4cGlyZVRpbWUpO1xyXG4gIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZU5hbWUgKyAnPScrIGNvb2tpZVZhbHVlICsnO2V4cGlyZXM9Jytub3cudG9VVENTdHJpbmcoKSsnO3BhdGg9Lyc7XHJcbn07XHJcblxyXG52YXIgZ2V0Q29va2llID0gZnVuY3Rpb24oY29va2llTmFtZSkge1xyXG4gIGxldCBuYW1lID0gY29va2llTmFtZSArIFwiPVwiO1xyXG4gIGxldCBkZWNvZGVkQ29va2llID0gZGVjb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmNvb2tpZSk7XHJcbiAgbGV0IGNhID0gZGVjb2RlZENvb2tpZS5zcGxpdCgnOycpO1xyXG4gIGZvcihsZXQgaSA9IDA7IGkgPGNhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBsZXQgYyA9IGNhW2ldO1xyXG4gICAgd2hpbGUgKGMuY2hhckF0KDApID09ICcgJykge1xyXG4gICAgICBjID0gYy5zdWJzdHJpbmcoMSk7XHJcbiAgICB9XHJcbiAgICBpZiAoYy5pbmRleE9mKG5hbWUpID09IDApIHtcclxuICAgICAgcmV0dXJuIGMuc3Vic3RyaW5nKG5hbWUubGVuZ3RoLCBjLmxlbmd0aCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBcIlwiO1xyXG59O1xyXG5cclxuXHJcblxyXG4vKiAwMS4gSGFuZGxlIEZpeGVkIEhlYWRlciBPcHRpb25cclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnZhciBoYW5kbGVIZWFkZXJGaXhlZFRvcCA9IGZ1bmN0aW9uKCkge1xyXG5cdGlmICgkKCcjaGVhZGVyW2RhdGEtZml4ZWQtdG9wPVwidHJ1ZVwiXScpLmxlbmd0aCAhPT0gMCkge1xyXG5cdFx0dmFyIHRhcmdldFNjcm9sbFRvcCA9ICQoJyN0b3AtbmF2JykuaGVpZ2h0KCk7XHJcblx0XHR2YXIgdGFyZ2V0UGFkZGluZ1RvcCA9ICQoJyNoZWFkZXInKS5oZWlnaHQoKTtcclxuXHRcdCQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPj0gdGFyZ2V0U2Nyb2xsVG9wKSB7XHJcblx0XHRcdFx0JCgnYm9keScpLmNzcygncGFkZGluZy10b3AnLCB0YXJnZXRQYWRkaW5nVG9wKTtcclxuXHRcdFx0XHQkKCcjaGVhZGVyJykuYWRkQ2xhc3MoJ2hlYWRlci1maXhlZCcpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQoJyNoZWFkZXInKS5yZW1vdmVDbGFzcygnaGVhZGVyLWZpeGVkJyk7XHJcblx0XHRcdFx0JCgnYm9keScpLmNzcygncGFkZGluZy10b3AnLCAnMCcpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyogMDIuIEhhbmRsZSBUb29sdGlwICYgUG9wb3ZlciBBY3RpdmF0aW9uXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlVG9vbHRpcFBvcG92ZXJBY3RpdmF0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0aWYgKCQoJ1tkYXRhLWJzLXRvZ2dsZT10b29sdGlwXScpLmxlbmd0aCAhPT0gMCkge1xyXG5cdFx0JCgnW2RhdGEtYnMtdG9nZ2xlPXRvb2x0aXBdJykudG9vbHRpcCgpO1xyXG5cdH1cclxuXHRpZiAoJCgnW2RhdGEtYnMtdG9nZ2xlPXBvcG92ZXJdJykubGVuZ3RoICE9PSAwKSB7XHJcblx0XHQkKCdbZGF0YS1icy10b2dnbGU9cG9wb3Zlcl0nKS5wb3BvdmVyKCk7XHJcblx0fVxyXG59O1xyXG5cclxuXHJcbi8qIDA0LiBIYW5kbGUgVGhlbWUgUGFuZWxcclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnZhciBoYW5kbGVUaGVtZVBhbmVsID0gZnVuY3Rpb24oKSB7XHJcblx0Ly8gVGhlbWUgUGFuZWwgLSBUb2dnbGUgLyBEaXNtaXNzXHJcblx0dmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1snKyBhcHAudGhlbWVQYW5lbC50b2dnbGVBdHRyICsnXScpO1xyXG5cdGlmIChlbG0pIHtcclxuXHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHZhciB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MpO1xyXG5cdFx0XHR2YXIgdGFyZ2V0RXhwYW5kID0gKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYXBwLnRoZW1lUGFuZWwuYWN0aXZlQ2xhc3MpKSA/IGZhbHNlIDogdHJ1ZTtcclxuXHRcdFx0XHJcblx0XHRcdHRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKGFwcC50aGVtZVBhbmVsLmFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0c2V0Q29va2llKGFwcC50aGVtZVBhbmVsLmNvb2tpZU5hbWUsIHRhcmdldEV4cGFuZCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8vIFRoZW1lIFBhbmVsIC0gVGhlbWUgU2VsZWN0b3JcclxuXHR2YXIgZWxtcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZS50b2dnbGVBdHRyICsnXScpKTtcclxuXHRpZiAoZWxtcykge1xyXG5cdFx0ZWxtcy5tYXAoZnVuY3Rpb24oZWxtKSB7XHJcblx0XHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dmFyIHRhcmdldFRoZW1lQ2xhc3MgPSB0aGlzLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZS5jbGFzc0F0dHIpO1xyXG5cdFx0XHRcdGZvciAodmFyIHggPSAwOyB4IDwgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QubGVuZ3RoOyB4KyspIHtcclxuXHRcdFx0XHRcdHZhciB0YXJnZXRDbGFzcyA9IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0W3hdO1xyXG5cdFx0XHRcdFx0aWYgKHRhcmdldENsYXNzLnNlYXJjaCgndGhlbWUtJykgPiAtMSkge1xyXG5cdFx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0Q2xhc3MpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAodGFyZ2V0VGhlbWVDbGFzcykge1xyXG5cdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKHRhcmdldFRoZW1lQ2xhc3MpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdFx0dmFyIHRvZ2dsZXJzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MgKycgWycrIGFwcC50aGVtZVBhbmVsLnRoZW1lLnRvZ2dsZUF0dHIgKyddJykpO1xyXG5cdFx0XHRcdHRvZ2dsZXJzLm1hcChmdW5jdGlvbih0b2dnbGVyKSB7XHJcblx0XHRcdFx0XHRpZiAodG9nZ2xlciAhPSBlbG0pIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlci5jbG9zZXN0KCcuJysgYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0SXRlbUNMYXNzKS5jbGFzc0xpc3QucmVtb3ZlKGFwcC50aGVtZVBhbmVsLnRoZW1lLmFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZXIuY2xvc2VzdCgnLicrIGFwcC50aGVtZVBhbmVsLnRoZW1lTGlzdEl0ZW1DTGFzcykuY2xhc3NMaXN0LmFkZChhcHAudGhlbWVQYW5lbC50aGVtZS5hY3RpdmVDbGFzcyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0c2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lLmNvb2tpZU5hbWUsIHRhcmdldFRoZW1lQ2xhc3MpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblx0XHJcblx0XHJcblx0Ly8gVGhlbWUgUGFuZWwgLSBEYXJrIE1vZGVcclxuXHR2YXIgZWxtcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZURhcmtNb2RlLnRvZ2dsZUF0dHIgKyddJykpO1xyXG5cdGVsbXMubWFwKGZ1bmN0aW9uKGVsbSkge1xyXG5cdFx0ZWxtLm9uY2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICh0aGlzLmNoZWNrZWQpIHtcclxuXHRcdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuc2V0QXR0cmlidXRlKGFwcC5kYXJrTW9kZS5hdHRyLCBhcHAuZGFya01vZGUudmFsdWUpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5yZW1vdmVBdHRyaWJ1dGUoYXBwLmRhcmtNb2RlLmF0dHIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdEFwcC5pbml0VmFyaWFibGUoKTtcclxuXHRcdFx0c2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lRGFya01vZGUuY29va2llTmFtZSwgKHRoaXMuY2hlY2tlZCkgPyBhcHAudGhlbWVQYW5lbC50aGVtZURhcmtNb2RlLmNsYXNzIDogJycpO1xyXG5cdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChhcHAuZGFya01vZGUuZXZlbnROYW1lKSk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0XHJcblx0XHJcblx0aWYgKGdldENvb2tpZShhcHAudGhlbWVQYW5lbC5jb29raWVOYW1lKSAmJiBnZXRDb29raWUoYXBwLnRoZW1lUGFuZWwuY29va2llTmFtZSkgPT0gJ3RydWUnKSB7XHJcblx0XHR2YXIgZWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50b2dnbGVBdHRyICsnXScpO1xyXG5cdFx0aWYgKGVsbSkge1xyXG5cdFx0XHRlbG0uY2xpY2soKTtcclxuXHRcdH1cclxuXHR9XHJcblx0aWYgKGdldENvb2tpZShhcHAudGhlbWVQYW5lbC50aGVtZS5jb29raWVOYW1lKSkge1xyXG5cdFx0dmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyArJyBbJysgYXBwLnRoZW1lUGFuZWwudGhlbWUudG9nZ2xlQXR0ciArJ11bJysgYXBwLnRoZW1lUGFuZWwudGhlbWUuY2xhc3NBdHRyICsnPVwiJysgZ2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lLmNvb2tpZU5hbWUpICsnXCJdJyk7XHJcblx0XHRpZiAoZWxtKSB7XHJcblx0XHRcdGVsbS5jbGljaygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRpZiAoZ2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lRGFya01vZGUuY29va2llTmFtZSkpIHtcclxuXHRcdHZhciBlbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MgKycgWycrIGFwcC50aGVtZVBhbmVsLnRoZW1lRGFya01vZGUudG9nZ2xlQXR0ciArJ10nKTtcclxuXHRcdGlmIChlbG0pIHtcclxuXHRcdFx0ZWxtLmNoZWNrZWQgPSB0cnVlO1xyXG5cdFx0XHRlbG0ub25jaGFuZ2UoKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyogMDUuIEhhbmRsZSBQYXltZW50IFR5cGUgU2VsZWN0aW9uXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlUGF5bWVudFR5cGVTZWxlY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuXHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtY2xpY2s9XCJzZXQtcGF5bWVudFwiXScsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdHZhciB0YXJnZXRMaSA9ICQodGhpcykuY2xvc2VzdCgnbGknKTtcclxuXHRcdHZhciB0YXJnZXRWYWx1ZSA9ICQodGhpcykuYXR0cignZGF0YS12YWx1ZScpO1xyXG5cdFx0XHJcblx0XHQkKCdbZGF0YS1jbGljaz1cInNldC1wYXltZW50XCJdJykuY2xvc2VzdCgnbGknKS5ub3QodGFyZ2V0TGkpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdCQoJ1tkYXRhLWlkPVwicGF5bWVudC10eXBlXCJdJykudmFsKHRhcmdldFZhbHVlKTtcclxuXHRcdCQodGFyZ2V0TGkpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHR9KTtcclxufTtcclxuXHJcblxyXG4vKiAwNi4gSGFuZGxlIENoZWNrb3V0IFF0eSBDb250cm9sXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlUXR5Q29udHJvbCA9IGZ1bmN0aW9uKCkge1xyXG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1jbGljaz1cImluY3JlYXNlLXF0eVwiXScsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdHZhciB0YXJnZXRJbnB1dCA9ICQodGhpcykuYXR0cignZGF0YS10YXJnZXQnKTtcclxuXHRcdHZhciB0YXJnZXRWYWx1ZSA9IHBhcnNlSW50KCQodGFyZ2V0SW5wdXQpLnZhbCgpKSArIDE7ICBcclxuXHRcdFxyXG5cdFx0JCh0YXJnZXRJbnB1dCkudmFsKHRhcmdldFZhbHVlKTtcclxuXHR9KTtcclxuXHQkKCdbZGF0YS1jbGljaz1cImRlY3JlYXNlLXF0eVwiXScpLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdHZhciB0YXJnZXRJbnB1dCA9ICQodGhpcykuYXR0cignZGF0YS10YXJnZXQnKTtcclxuXHRcdHZhciB0YXJnZXRWYWx1ZSA9IHBhcnNlSW50KCQodGFyZ2V0SW5wdXQpLnZhbCgpKSAtIDE7ICBcclxuXHRcdCAgICB0YXJnZXRWYWx1ZSA9ICh0YXJnZXRWYWx1ZSA8IDApID8gMCA6IHRhcmdldFZhbHVlO1xyXG5cdFx0XHJcblx0XHQkKHRhcmdldElucHV0KS52YWwodGFyZ2V0VmFsdWUpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuXHJcbi8qIDA3LiBIYW5kbGUgUHJvZHVjdCBJbWFnZVxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhhbmRsZVByb2R1Y3RJbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1jbGljaz1cInNob3ctbWFpbi1pbWFnZVwiXScsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0XHR2YXIgdGFyZ2V0Q29udGFpbmVyID0gJ1tkYXRhLWlkPVwibWFpbi1pbWFnZVwiXSc7XHJcblx0XHR2YXIgdGFyZ2V0SW1hZ2UgPSAnPGltZyBzcmM9XCInKyAkKHRoaXMpLmF0dHIoJ2RhdGEtdXJsJykgKydcIiAvPic7XHJcblx0XHR2YXIgdGFyZ2V0TGkgPSAkKHRoaXMpLmNsb3Nlc3QoJ2xpJyk7XHJcblxyXG5cdFx0JCh0YXJnZXRDb250YWluZXIpLmh0bWwodGFyZ2V0SW1hZ2UpO1xyXG5cdFx0JCh0YXJnZXRMaSkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdFx0JCgnW2RhdGEtY2xpY2s9XCJzaG93LW1haW4taW1hZ2VcIl0nKS5jbG9zZXN0KCdsaScpLm5vdCh0YXJnZXRMaSkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuXHJcbi8qIDA4LiBIYW5kbGUgUGFyb2xsZXJcclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnZhciBoYW5kbGVQYXJvbGxlciA9IGZ1bmN0aW9uKCkge1xyXG5cdGlmICh0eXBlb2YgJC5mbi5wYXJvbGxlciAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuXHRcdGlmICgkKCdbZGF0YS1wYXJvbGxlcj1cInRydWVcIl0nKS5sZW5ndGggIT09IDApIHtcclxuXHRcdFx0JCgnW2RhdGEtcGFyb2xsZXI9XCJ0cnVlXCJdJykucGFyb2xsZXIoKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyogMDkuIEhhbmRsZSBDaGVjayBCb290c3RyYXAgVmVyc2lvblxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhhbmRsZUNoZWNrQm9vdHN0cmFwVmVyc2lvbiA9IGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiBwYXJzZUludCgkLmZuLnRvb2x0aXAuQ29uc3RydWN0b3IuVkVSU0lPTik7XHJcbn07XHJcblxyXG5cclxuLyogMTAuIEhhbmRsZSBHZXQgQ3NzIFZhcmlhYmxlXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlQ3NzVmFyaWFibGUgPSBmdW5jdGlvbigpIHtcclxuXHR2YXIgcm9vdFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KTtcclxuXHRcclxuXHQvLyBmb250XHJcblx0aWYgKGFwcC52YXJpYWJsZUZvbnRMaXN0ICYmIGFwcC52YXJpYWJsZVByZWZpeCkge1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAoYXBwLnZhcmlhYmxlRm9udExpc3QpLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGFwcC5mb250W2FwcC52YXJpYWJsZUZvbnRMaXN0W2ldLnJlcGxhY2UoLy0oW2EtenwwLTldKS9nLCAobWF0Y2gsIGxldHRlcikgPT4gbGV0dGVyLnRvVXBwZXJDYXNlKCkpXSA9IHJvb3RTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLScrIGFwcC52YXJpYWJsZVByZWZpeCArIGFwcC52YXJpYWJsZUZvbnRMaXN0W2ldKS50cmltKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8vIGNvbG9yXHJcblx0aWYgKGFwcC52YXJpYWJsZUNvbG9yTGlzdCAmJiBhcHAudmFyaWFibGVQcmVmaXgpIHtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgKGFwcC52YXJpYWJsZUNvbG9yTGlzdCkubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0YXBwLmNvbG9yW2FwcC52YXJpYWJsZUNvbG9yTGlzdFtpXS5yZXBsYWNlKC8tKFthLXp8MC05XSkvZywgKG1hdGNoLCBsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKV0gPSByb290U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS0nKyBhcHAudmFyaWFibGVQcmVmaXggKyBhcHAudmFyaWFibGVDb2xvckxpc3RbaV0pLnRyaW0oKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyogQXBwbGljYXRpb24gQ29udHJvbGxlclxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIEFwcCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly9tYWluIGZ1bmN0aW9uXHJcblx0XHRpbml0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGhhbmRsZUhlYWRlckZpeGVkVG9wKCk7XHJcblx0XHRcdGhhbmRsZVRvb2x0aXBQb3BvdmVyQWN0aXZhdGlvbigpO1xyXG5cdFx0XHRoYW5kbGVUaGVtZVBhbmVsKCk7XHJcblx0XHRcdGhhbmRsZVBheW1lbnRUeXBlU2VsZWN0aW9uKCk7XHJcblx0XHRcdGhhbmRsZVF0eUNvbnRyb2woKTtcclxuXHRcdFx0aGFuZGxlUHJvZHVjdEltYWdlKCk7XHJcblx0XHRcdGhhbmRsZVBhcm9sbGVyKCk7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmluaXRWYXJpYWJsZSgpO1xyXG5cdFx0fSxcclxuXHRcdGluaXRWYXJpYWJsZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGhhbmRsZUNzc1ZhcmlhYmxlKCk7XHJcblx0XHR9XHJcblx0fTtcclxufSgpO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcblx0QXBwLmluaXQoKTtcclxufSk7Il19
