/*
Template Name: Color Admin - Responsive Admin Dashboard Template build with Bootstrap 5
Version: 5.3.2
Author: Sean Ngu
Website: http://www.seantheme.com/color-admin/
	----------------------------
			APPS CONTENT TABLE
	----------------------------
	
	<!-- ======== GLOBAL SCRIPT SETTING ======== -->
	01. Handle Header Mobile Nav
	02. Handle Theme Panel Expand
	03. Handle Tooltip Activation
  04. Handle Get Css Variable

	<!-- ======== APPLICATION SETTING ======== -->
	Application Controller
*/

var app = {
	id: '#app',
	class: 'app',
	isMobile: ((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) || window.innerWidth < 767),
	darkMode: {
		attr: 'data-bs-theme',
		value: 'dark',
		eventName: 'theme-reload'
	},
	themePanel: {
		class: 'theme-panel',
		toggleAttr: 'data-toggle="theme-panel-expand"',
		cookieName: 'theme-panel-expand',
		activeClass: 'active',
		themeListCLass: 'theme-list',
		themeListItemCLass: 'theme-list-item',
		theme: {
			toggleAttr: 'data-toggle="theme-selector"',
			cookieName: 'app-theme',
			activeClass: 'active',
			classAttr: 'data-theme-class'
		},
		themeDarkMode: {
			class: 'dark-mode',
			toggleAttr: 'name="app-theme-dark-mode"',
			cookieName: 'app-theme-dark-mode'
		},
	},
	font: {},
	color: {},
	variablePrefix: 'bs-',
	variableFontList: ['body-font-family', 'body-font-size', 'body-font-weight', 'body-line-height'],
	variableColorList: [
		'theme', 'theme-rgb', 'theme-color', 'theme-color-rgb',
		'component-color', 'component-color-rgb', 'component-bg', 'component-bg-rgb',
		'component-secondary-bg', 'component-bg-rgb', 'component-tertiary-bg', 'component-tertiary-bg-rgb',
		'default', 'default-rgb',
		'primary', 'primary-rgb', 'primary-bg-subtle', 'primary-text', 'primary-border-subtle',
		'secondary', 'secondary-rgb', 'secondary-bg-subtle', 'secondary-text', 'secondary-border-subtle',
		'success', 'success-rgb', 'success-bg-subtle', 'success-text', 'success-border-subtle',
		'warning', 'warning-rgb', 'warning-bg-subtle', 'warning-text', 'warning-border-subtle',
		'info', 'info-rgb', 'info-bg-subtle', 'info-text', 'info-border-subtle',
		'danger', 'danger-rgb', 'danger-bg-subtle', 'danger-text', 'danger-border-subtle',
		'light', 'light-rgb', 'light-bg-subtle', 'light-text', 'light-border-subtle',
		'dark', 'dark-rgb', 'dark-bg-subtle', 'dark-text', 'dark-border-subtle',
		'black', 'black-rgb',
		'blue', 'blue-rgb', 
		'inverse', 'inverse-rgb',
		'white', 'white-rgb',
		'red', 'red-rgb', 
		'teal', 'teal-rgb',
		'indigo', 'indigo-rgb', 
		'orange', 'orange-rgb', 
		'purple', 'purple-rgb',
		'yellow', 'yellow-rgb',
		'green', 'green-rgb',
		'pink', 'pink-rgb',
		'cyan', 'cyan-rgb',
		'gray', 'gray-rgb',
		'lime', 'lime-rgb',
		'gray-100', 'gray-200', 'gray-300', 'gray-400', 'gray-500',  'gray-600', 'gray-700', 'gray-800', 'gray-900', 
		'gray-100-rgb', 'gray-200-rgb', 'gray-300-rgb', 'gray-400-rgb', 'gray-500-rgb',  'gray-600-rgb', 'gray-700-rgb', 'gray-800-rgb', 'gray-900-rgb', 
		'muted', 'muted-rgb', 'emphasis-color', 'emphasis-color-rgb',
		'heading-color', 
		'body-bg', 'body-bg-rgb', 'body-color', 'body-color-rgb',
		'secondary-color', 'secondary-color-rgb', 'secondary-bg', 'secondary-bg-rgb',
		'tertiary-color', 'tertiary-color-rgb', 'tertiary-bg', 'tertiary-bg-rgb',
		'link-color', 'link-color-rgb', 'link-hover-color', 'link-hover-color-rgb', 
		'border-color', 'border-color-translucent'
	],
	breakpoints: {
		xs: 0,
		sm: 576,
		md: 768,
		lg: 992,
		xl: 1200,
		xxl: 1400,
		xxxl: 1800
	}
}

var slideUp = function(elm, duration = app.animation.speed) {
	if (!elm.classList.contains('transitioning')) {
		elm.classList.add('transitioning');
		elm.style.transitionProperty = 'height, margin, padding';
		elm.style.transitionDuration = duration + 'ms';
		elm.style.boxSizing = 'border-box';
		elm.style.height = elm.offsetHeight + 'px';
		elm.offsetHeight;
		elm.style.overflow = 'hidden';
		elm.style.height = 0;
		elm.style.paddingTop = 0;
		elm.style.paddingBottom = 0;
		elm.style.marginTop = 0;
		elm.style.marginBottom = 0;
		window.setTimeout( () => {
			elm.style.display = 'none';
			elm.style.removeProperty('height');
			elm.style.removeProperty('padding-top');
			elm.style.removeProperty('padding-bottom');
			elm.style.removeProperty('margin-top');
			elm.style.removeProperty('margin-bottom');
			elm.style.removeProperty('overflow');
			elm.style.removeProperty('transition-duration');
			elm.style.removeProperty('transition-property');
			elm.classList.remove('transitioning');
		}, duration);
	}
};

var slideDown = function(elm, duration = app.animation.speed) {
	if (!elm.classList.contains('transitioning')) {
		elm.classList.add('transitioning');
		elm.style.removeProperty('display');
		let display = window.getComputedStyle(elm).display;
		if (display === 'none') display = 'block';
		elm.style.display = display;
		let height = elm.offsetHeight;
		elm.style.overflow = 'hidden';
		elm.style.height = 0;
		elm.style.paddingTop = 0;
		elm.style.paddingBottom = 0;
		elm.style.marginTop = 0;
		elm.style.marginBottom = 0;
		elm.offsetHeight;
		elm.style.boxSizing = 'border-box';
		elm.style.transitionProperty = "height, margin, padding";
		elm.style.transitionDuration = duration + 'ms';
		elm.style.height = height + 'px';
		elm.style.removeProperty('padding-top');
		elm.style.removeProperty('padding-bottom');
		elm.style.removeProperty('margin-top');
		elm.style.removeProperty('margin-bottom');
		window.setTimeout( () => {
			elm.style.removeProperty('height');
			elm.style.removeProperty('overflow');
			elm.style.removeProperty('transition-duration');
			elm.style.removeProperty('transition-property');
			elm.classList.remove('transitioning');
		}, duration);
	}
};

var slideToggle = function(elm, duration = app.animation.speed) {
	if (window.getComputedStyle(elm).display === 'none') {
		return slideDown(elm, duration);
	} else {
		return slideUp(elm, duration);
	}
};

var setCookie = function(cookieName, cookieValue) {
	var now = new Date();
  var time = now.getTime();
  var expireTime = time + 1000*36000;
  now.setTime(expireTime);
  document.cookie = cookieName + '='+ cookieValue +';expires='+now.toUTCString()+';path=/';
};

var getCookie = function(cookieName) {
  let name = cookieName + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
};


/* 01. Handle Header Mobile Nav
------------------------------------------------ */
var handleHeaderMobileNav = function() {
	$(document).on('click', '[data-toggle="header-mobile-nav"]', function(e) {
		e.preventDefault();
	
		$('.header .header-nav').slideToggle();
	});
};


/* 02. Handle Theme Panel
------------------------------------------------ */
var handleThemePanel = function() {
	// Theme Panel - Toggle / Dismiss
	var elm = document.querySelector('['+ app.themePanel.toggleAttr +']');
	if (elm) {
		elm.onclick = function(e) {
			e.preventDefault();
			var target = document.querySelector('.'+ app.themePanel.class);
			var targetExpand = (target.classList.contains(app.themePanel.activeClass)) ? false : true;
			
			target.classList.toggle(app.themePanel.activeClass);
			setCookie(app.themePanel.cookieName, targetExpand);
		}
	}
	
	// Theme Panel - Theme Selector
	var elms = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']'));
	if (elms) {
		elms.map(function(elm) {
			elm.onclick = function() {
				var targetThemeClass = this.getAttribute(app.themePanel.theme.classAttr);
				for (var x = 0; x < document.body.classList.length; x++) {
					var targetClass = document.body.classList[x];
					if (targetClass.search('theme-') > -1) {
						document.body.classList.remove(targetClass);
					}
				}
				if (targetThemeClass) {
					document.body.classList.add(targetThemeClass);
				}
			
				var togglers = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']'));
				togglers.map(function(toggler) {
					if (toggler != elm) {
						toggler.closest('.'+ app.themePanel.themeListItemCLass).classList.remove(app.themePanel.theme.activeClass);
					} else {
						toggler.closest('.'+ app.themePanel.themeListItemCLass).classList.add(app.themePanel.theme.activeClass);
					}
				});
				setCookie(app.themePanel.theme.cookieName, targetThemeClass);
			}
		});
	}
	
	
	// Theme Panel - Dark Mode
	var elms = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.themeDarkMode.toggleAttr +']'));
	elms.map(function(elm) {
		elm.onchange = function() {
			if (this.checked) {
				document.querySelector('html').setAttribute(app.darkMode.attr, app.darkMode.value);
			} else {
				document.querySelector('html').removeAttribute(app.darkMode.attr);
			}
			App.initVariable();
			setCookie(app.themePanel.themeDarkMode.cookieName, (this.checked) ? app.themePanel.themeDarkMode.class : '');
			document.dispatchEvent(new CustomEvent(app.darkMode.eventName));
		}
	});
	
	
	if (getCookie(app.themePanel.cookieName) && getCookie(app.themePanel.cookieName) == 'true') {
		var elm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.toggleAttr +']');
		if (elm) {
			elm.click();
		}
	}
	if (getCookie(app.themePanel.theme.cookieName)) {
		var elm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']['+ app.themePanel.theme.classAttr +'="'+ getCookie(app.themePanel.theme.cookieName) +'"]');
		if (elm) {
			elm.click();
		}
	}
	if (getCookie(app.themePanel.themeDarkMode.cookieName)) {
		var elm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.themeDarkMode.toggleAttr +']');
		if (elm) {
			elm.checked = true;
			elm.onchange();
		}
	}
};


/* 03. Handle Tooltip Activation
------------------------------------------------ */
var handleTooltipActivation = function() {
	if ($('[data-bs-toggle=tooltip]').length !== 0) {
		$('[data-bs-toggle=tooltip]').tooltip();
	}
};


/* 04. Handle Get Css Variable
------------------------------------------------ */
var handleCssVariable = function() {
	var rootStyle = getComputedStyle(document.body);
	
	// font
	if (app.variableFontList && app.variablePrefix) {
		for (var i = 0; i < (app.variableFontList).length; i++) {
			app.font[app.variableFontList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableFontList[i]).trim();
		}
	}
	
	// color
	if (app.variableColorList && app.variablePrefix) {
		for (var i = 0; i < (app.variableColorList).length; i++) {
			app.color[app.variableColorList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableColorList[i]).trim();
		}
	}
};


/* Application Controller
------------------------------------------------ */
var App = function () {
	"use strict";
	
	return {
		//main function
		init: function () {
			handleHeaderMobileNav();
			handleThemePanel()
			handleTooltipActivation();
			
			this.initVariable();
		},
		initVariable: function() {
			handleCssVariable();
		}
  };
}();

$(document).ready(function() {
	App.init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuVGVtcGxhdGUgTmFtZTogQ29sb3IgQWRtaW4gLSBSZXNwb25zaXZlIEFkbWluIERhc2hib2FyZCBUZW1wbGF0ZSBidWlsZCB3aXRoIEJvb3RzdHJhcCA1XHJcblZlcnNpb246IDUuMy4xXHJcbkF1dGhvcjogU2VhbiBOZ3VcclxuV2Vic2l0ZTogaHR0cDovL3d3dy5zZWFudGhlbWUuY29tL2NvbG9yLWFkbWluL1xyXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdFx0QVBQUyBDT05URU5UIFRBQkxFXHJcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdFxyXG5cdDwhLS0gPT09PT09PT0gR0xPQkFMIFNDUklQVCBTRVRUSU5HID09PT09PT09IC0tPlxyXG5cdDAxLiBIYW5kbGUgSGVhZGVyIE1vYmlsZSBOYXZcclxuXHQwMi4gSGFuZGxlIFRoZW1lIFBhbmVsIEV4cGFuZFxyXG5cdDAzLiBIYW5kbGUgVG9vbHRpcCBBY3RpdmF0aW9uXHJcbiAgMDQuIEhhbmRsZSBHZXQgQ3NzIFZhcmlhYmxlXHJcblxyXG5cdDwhLS0gPT09PT09PT0gQVBQTElDQVRJT04gU0VUVElORyA9PT09PT09PSAtLT5cclxuXHRBcHBsaWNhdGlvbiBDb250cm9sbGVyXHJcbiovXHJcblxyXG52YXIgYXBwID0ge1xyXG5cdGlkOiAnI2FwcCcsXHJcblx0Y2xhc3M6ICdhcHAnLFxyXG5cdGlzTW9iaWxlOiAoKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgfHwgd2luZG93LmlubmVyV2lkdGggPCA3NjcpLFxyXG5cdGRhcmtNb2RlOiB7XHJcblx0XHRhdHRyOiAnZGF0YS1icy10aGVtZScsXHJcblx0XHR2YWx1ZTogJ2RhcmsnLFxyXG5cdFx0ZXZlbnROYW1lOiAndGhlbWUtcmVsb2FkJ1xyXG5cdH0sXHJcblx0dGhlbWVQYW5lbDoge1xyXG5cdFx0Y2xhc3M6ICd0aGVtZS1wYW5lbCcsXHJcblx0XHR0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJ0aGVtZS1wYW5lbC1leHBhbmRcIicsXHJcblx0XHRjb29raWVOYW1lOiAndGhlbWUtcGFuZWwtZXhwYW5kJyxcclxuXHRcdGFjdGl2ZUNsYXNzOiAnYWN0aXZlJyxcclxuXHRcdHRoZW1lTGlzdENMYXNzOiAndGhlbWUtbGlzdCcsXHJcblx0XHR0aGVtZUxpc3RJdGVtQ0xhc3M6ICd0aGVtZS1saXN0LWl0ZW0nLFxyXG5cdFx0dGhlbWU6IHtcclxuXHRcdFx0dG9nZ2xlQXR0cjogJ2RhdGEtdG9nZ2xlPVwidGhlbWUtc2VsZWN0b3JcIicsXHJcblx0XHRcdGNvb2tpZU5hbWU6ICdhcHAtdGhlbWUnLFxyXG5cdFx0XHRhY3RpdmVDbGFzczogJ2FjdGl2ZScsXHJcblx0XHRcdGNsYXNzQXR0cjogJ2RhdGEtdGhlbWUtY2xhc3MnXHJcblx0XHR9LFxyXG5cdFx0dGhlbWVEYXJrTW9kZToge1xyXG5cdFx0XHRjbGFzczogJ2RhcmstbW9kZScsXHJcblx0XHRcdHRvZ2dsZUF0dHI6ICduYW1lPVwiYXBwLXRoZW1lLWRhcmstbW9kZVwiJyxcclxuXHRcdFx0Y29va2llTmFtZTogJ2FwcC10aGVtZS1kYXJrLW1vZGUnXHJcblx0XHR9LFxyXG5cdH0sXHJcblx0Zm9udDoge30sXHJcblx0Y29sb3I6IHt9LFxyXG5cdHZhcmlhYmxlUHJlZml4OiAnYnMtJyxcclxuXHR2YXJpYWJsZUZvbnRMaXN0OiBbJ2JvZHktZm9udC1mYW1pbHknLCAnYm9keS1mb250LXNpemUnLCAnYm9keS1mb250LXdlaWdodCcsICdib2R5LWxpbmUtaGVpZ2h0J10sXHJcblx0dmFyaWFibGVDb2xvckxpc3Q6IFtcclxuXHRcdCd0aGVtZScsICd0aGVtZS1yZ2InLCAndGhlbWUtY29sb3InLCAndGhlbWUtY29sb3ItcmdiJyxcclxuXHRcdCdjb21wb25lbnQtY29sb3InLCAnY29tcG9uZW50LWNvbG9yLXJnYicsICdjb21wb25lbnQtYmcnLCAnY29tcG9uZW50LWJnLXJnYicsXHJcblx0XHQnY29tcG9uZW50LXNlY29uZGFyeS1iZycsICdjb21wb25lbnQtYmctcmdiJywgJ2NvbXBvbmVudC10ZXJ0aWFyeS1iZycsICdjb21wb25lbnQtdGVydGlhcnktYmctcmdiJyxcclxuXHRcdCdkZWZhdWx0JywgJ2RlZmF1bHQtcmdiJyxcclxuXHRcdCdwcmltYXJ5JywgJ3ByaW1hcnktcmdiJywgJ3ByaW1hcnktYmctc3VidGxlJywgJ3ByaW1hcnktdGV4dCcsICdwcmltYXJ5LWJvcmRlci1zdWJ0bGUnLFxyXG5cdFx0J3NlY29uZGFyeScsICdzZWNvbmRhcnktcmdiJywgJ3NlY29uZGFyeS1iZy1zdWJ0bGUnLCAnc2Vjb25kYXJ5LXRleHQnLCAnc2Vjb25kYXJ5LWJvcmRlci1zdWJ0bGUnLFxyXG5cdFx0J3N1Y2Nlc3MnLCAnc3VjY2Vzcy1yZ2InLCAnc3VjY2Vzcy1iZy1zdWJ0bGUnLCAnc3VjY2Vzcy10ZXh0JywgJ3N1Y2Nlc3MtYm9yZGVyLXN1YnRsZScsXHJcblx0XHQnd2FybmluZycsICd3YXJuaW5nLXJnYicsICd3YXJuaW5nLWJnLXN1YnRsZScsICd3YXJuaW5nLXRleHQnLCAnd2FybmluZy1ib3JkZXItc3VidGxlJyxcclxuXHRcdCdpbmZvJywgJ2luZm8tcmdiJywgJ2luZm8tYmctc3VidGxlJywgJ2luZm8tdGV4dCcsICdpbmZvLWJvcmRlci1zdWJ0bGUnLFxyXG5cdFx0J2RhbmdlcicsICdkYW5nZXItcmdiJywgJ2Rhbmdlci1iZy1zdWJ0bGUnLCAnZGFuZ2VyLXRleHQnLCAnZGFuZ2VyLWJvcmRlci1zdWJ0bGUnLFxyXG5cdFx0J2xpZ2h0JywgJ2xpZ2h0LXJnYicsICdsaWdodC1iZy1zdWJ0bGUnLCAnbGlnaHQtdGV4dCcsICdsaWdodC1ib3JkZXItc3VidGxlJyxcclxuXHRcdCdkYXJrJywgJ2RhcmstcmdiJywgJ2RhcmstYmctc3VidGxlJywgJ2RhcmstdGV4dCcsICdkYXJrLWJvcmRlci1zdWJ0bGUnLFxyXG5cdFx0J2JsYWNrJywgJ2JsYWNrLXJnYicsXHJcblx0XHQnYmx1ZScsICdibHVlLXJnYicsIFxyXG5cdFx0J2ludmVyc2UnLCAnaW52ZXJzZS1yZ2InLFxyXG5cdFx0J3doaXRlJywgJ3doaXRlLXJnYicsXHJcblx0XHQncmVkJywgJ3JlZC1yZ2InLCBcclxuXHRcdCd0ZWFsJywgJ3RlYWwtcmdiJyxcclxuXHRcdCdpbmRpZ28nLCAnaW5kaWdvLXJnYicsIFxyXG5cdFx0J29yYW5nZScsICdvcmFuZ2UtcmdiJywgXHJcblx0XHQncHVycGxlJywgJ3B1cnBsZS1yZ2InLFxyXG5cdFx0J3llbGxvdycsICd5ZWxsb3ctcmdiJyxcclxuXHRcdCdncmVlbicsICdncmVlbi1yZ2InLFxyXG5cdFx0J3BpbmsnLCAncGluay1yZ2InLFxyXG5cdFx0J2N5YW4nLCAnY3lhbi1yZ2InLFxyXG5cdFx0J2dyYXknLCAnZ3JheS1yZ2InLFxyXG5cdFx0J2xpbWUnLCAnbGltZS1yZ2InLFxyXG5cdFx0J2dyYXktMTAwJywgJ2dyYXktMjAwJywgJ2dyYXktMzAwJywgJ2dyYXktNDAwJywgJ2dyYXktNTAwJywgICdncmF5LTYwMCcsICdncmF5LTcwMCcsICdncmF5LTgwMCcsICdncmF5LTkwMCcsIFxyXG5cdFx0J2dyYXktMTAwLXJnYicsICdncmF5LTIwMC1yZ2InLCAnZ3JheS0zMDAtcmdiJywgJ2dyYXktNDAwLXJnYicsICdncmF5LTUwMC1yZ2InLCAgJ2dyYXktNjAwLXJnYicsICdncmF5LTcwMC1yZ2InLCAnZ3JheS04MDAtcmdiJywgJ2dyYXktOTAwLXJnYicsIFxyXG5cdFx0J211dGVkJywgJ211dGVkLXJnYicsICdlbXBoYXNpcy1jb2xvcicsICdlbXBoYXNpcy1jb2xvci1yZ2InLFxyXG5cdFx0J2hlYWRpbmctY29sb3InLCBcclxuXHRcdCdib2R5LWJnJywgJ2JvZHktYmctcmdiJywgJ2JvZHktY29sb3InLCAnYm9keS1jb2xvci1yZ2InLFxyXG5cdFx0J3NlY29uZGFyeS1jb2xvcicsICdzZWNvbmRhcnktY29sb3ItcmdiJywgJ3NlY29uZGFyeS1iZycsICdzZWNvbmRhcnktYmctcmdiJyxcclxuXHRcdCd0ZXJ0aWFyeS1jb2xvcicsICd0ZXJ0aWFyeS1jb2xvci1yZ2InLCAndGVydGlhcnktYmcnLCAndGVydGlhcnktYmctcmdiJyxcclxuXHRcdCdsaW5rLWNvbG9yJywgJ2xpbmstY29sb3ItcmdiJywgJ2xpbmstaG92ZXItY29sb3InLCAnbGluay1ob3Zlci1jb2xvci1yZ2InLCBcclxuXHRcdCdib3JkZXItY29sb3InLCAnYm9yZGVyLWNvbG9yLXRyYW5zbHVjZW50J1xyXG5cdF0sXHJcblx0YnJlYWtwb2ludHM6IHtcclxuXHRcdHhzOiAwLFxyXG5cdFx0c206IDU3NixcclxuXHRcdG1kOiA3NjgsXHJcblx0XHRsZzogOTkyLFxyXG5cdFx0eGw6IDEyMDAsXHJcblx0XHR4eGw6IDE0MDAsXHJcblx0XHR4eHhsOiAxODAwXHJcblx0fVxyXG59XHJcblxyXG52YXIgc2xpZGVVcCA9IGZ1bmN0aW9uKGVsbSwgZHVyYXRpb24gPSBhcHAuYW5pbWF0aW9uLnNwZWVkKSB7XHJcblx0aWYgKCFlbG0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0cmFuc2l0aW9uaW5nJykpIHtcclxuXHRcdGVsbS5jbGFzc0xpc3QuYWRkKCd0cmFuc2l0aW9uaW5nJyk7XHJcblx0XHRlbG0uc3R5bGUudHJhbnNpdGlvblByb3BlcnR5ID0gJ2hlaWdodCwgbWFyZ2luLCBwYWRkaW5nJztcclxuXHRcdGVsbS5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSBkdXJhdGlvbiArICdtcyc7XHJcblx0XHRlbG0uc3R5bGUuYm94U2l6aW5nID0gJ2JvcmRlci1ib3gnO1xyXG5cdFx0ZWxtLnN0eWxlLmhlaWdodCA9IGVsbS5vZmZzZXRIZWlnaHQgKyAncHgnO1xyXG5cdFx0ZWxtLm9mZnNldEhlaWdodDtcclxuXHRcdGVsbS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xyXG5cdFx0ZWxtLnN0eWxlLmhlaWdodCA9IDA7XHJcblx0XHRlbG0uc3R5bGUucGFkZGluZ1RvcCA9IDA7XHJcblx0XHRlbG0uc3R5bGUucGFkZGluZ0JvdHRvbSA9IDA7XHJcblx0XHRlbG0uc3R5bGUubWFyZ2luVG9wID0gMDtcclxuXHRcdGVsbS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAwO1xyXG5cdFx0d2luZG93LnNldFRpbWVvdXQoICgpID0+IHtcclxuXHRcdFx0ZWxtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnaGVpZ2h0Jyk7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgncGFkZGluZy10b3AnKTtcclxuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdwYWRkaW5nLWJvdHRvbScpO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ21hcmdpbi10b3AnKTtcclxuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdtYXJnaW4tYm90dG9tJyk7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnb3ZlcmZsb3cnKTtcclxuXHRcdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCd0cmFuc2l0aW9uLWR1cmF0aW9uJyk7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgndHJhbnNpdGlvbi1wcm9wZXJ0eScpO1xyXG5cdFx0XHRlbG0uY2xhc3NMaXN0LnJlbW92ZSgndHJhbnNpdGlvbmluZycpO1xyXG5cdFx0fSwgZHVyYXRpb24pO1xyXG5cdH1cclxufTtcclxuXHJcbnZhciBzbGlkZURvd24gPSBmdW5jdGlvbihlbG0sIGR1cmF0aW9uID0gYXBwLmFuaW1hdGlvbi5zcGVlZCkge1xyXG5cdGlmICghZWxtLmNsYXNzTGlzdC5jb250YWlucygndHJhbnNpdGlvbmluZycpKSB7XHJcblx0XHRlbG0uY2xhc3NMaXN0LmFkZCgndHJhbnNpdGlvbmluZycpO1xyXG5cdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdkaXNwbGF5Jyk7XHJcblx0XHRsZXQgZGlzcGxheSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsbSkuZGlzcGxheTtcclxuXHRcdGlmIChkaXNwbGF5ID09PSAnbm9uZScpIGRpc3BsYXkgPSAnYmxvY2snO1xyXG5cdFx0ZWxtLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5O1xyXG5cdFx0bGV0IGhlaWdodCA9IGVsbS5vZmZzZXRIZWlnaHQ7XHJcblx0XHRlbG0uc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuXHRcdGVsbS5zdHlsZS5oZWlnaHQgPSAwO1xyXG5cdFx0ZWxtLnN0eWxlLnBhZGRpbmdUb3AgPSAwO1xyXG5cdFx0ZWxtLnN0eWxlLnBhZGRpbmdCb3R0b20gPSAwO1xyXG5cdFx0ZWxtLnN0eWxlLm1hcmdpblRvcCA9IDA7XHJcblx0XHRlbG0uc3R5bGUubWFyZ2luQm90dG9tID0gMDtcclxuXHRcdGVsbS5vZmZzZXRIZWlnaHQ7XHJcblx0XHRlbG0uc3R5bGUuYm94U2l6aW5nID0gJ2JvcmRlci1ib3gnO1xyXG5cdFx0ZWxtLnN0eWxlLnRyYW5zaXRpb25Qcm9wZXJ0eSA9IFwiaGVpZ2h0LCBtYXJnaW4sIHBhZGRpbmdcIjtcclxuXHRcdGVsbS5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSBkdXJhdGlvbiArICdtcyc7XHJcblx0XHRlbG0uc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcclxuXHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgncGFkZGluZy10b3AnKTtcclxuXHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgncGFkZGluZy1ib3R0b20nKTtcclxuXHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnbWFyZ2luLXRvcCcpO1xyXG5cdFx0ZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdtYXJnaW4tYm90dG9tJyk7XHJcblx0XHR3aW5kb3cuc2V0VGltZW91dCggKCkgPT4ge1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2hlaWdodCcpO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ292ZXJmbG93Jyk7XHJcblx0XHRcdGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgndHJhbnNpdGlvbi1kdXJhdGlvbicpO1xyXG5cdFx0XHRlbG0uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3RyYW5zaXRpb24tcHJvcGVydHknKTtcclxuXHRcdFx0ZWxtLmNsYXNzTGlzdC5yZW1vdmUoJ3RyYW5zaXRpb25pbmcnKTtcclxuXHRcdH0sIGR1cmF0aW9uKTtcclxuXHR9XHJcbn07XHJcblxyXG52YXIgc2xpZGVUb2dnbGUgPSBmdW5jdGlvbihlbG0sIGR1cmF0aW9uID0gYXBwLmFuaW1hdGlvbi5zcGVlZCkge1xyXG5cdGlmICh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbG0pLmRpc3BsYXkgPT09ICdub25lJykge1xyXG5cdFx0cmV0dXJuIHNsaWRlRG93bihlbG0sIGR1cmF0aW9uKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIHNsaWRlVXAoZWxtLCBkdXJhdGlvbik7XHJcblx0fVxyXG59O1xyXG5cclxudmFyIHNldENvb2tpZSA9IGZ1bmN0aW9uKGNvb2tpZU5hbWUsIGNvb2tpZVZhbHVlKSB7XHJcblx0dmFyIG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgdmFyIHRpbWUgPSBub3cuZ2V0VGltZSgpO1xyXG4gIHZhciBleHBpcmVUaW1lID0gdGltZSArIDEwMDAqMzYwMDA7XHJcbiAgbm93LnNldFRpbWUoZXhwaXJlVGltZSk7XHJcbiAgZG9jdW1lbnQuY29va2llID0gY29va2llTmFtZSArICc9JysgY29va2llVmFsdWUgKyc7ZXhwaXJlcz0nK25vdy50b1VUQ1N0cmluZygpKyc7cGF0aD0vJztcclxufTtcclxuXHJcbnZhciBnZXRDb29raWUgPSBmdW5jdGlvbihjb29raWVOYW1lKSB7XHJcbiAgbGV0IG5hbWUgPSBjb29raWVOYW1lICsgXCI9XCI7XHJcbiAgbGV0IGRlY29kZWRDb29raWUgPSBkZWNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQuY29va2llKTtcclxuICBsZXQgY2EgPSBkZWNvZGVkQ29va2llLnNwbGl0KCc7Jyk7XHJcbiAgZm9yKGxldCBpID0gMDsgaSA8Y2EubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBjID0gY2FbaV07XHJcbiAgICB3aGlsZSAoYy5jaGFyQXQoMCkgPT0gJyAnKSB7XHJcbiAgICAgIGMgPSBjLnN1YnN0cmluZygxKTtcclxuICAgIH1cclxuICAgIGlmIChjLmluZGV4T2YobmFtZSkgPT0gMCkge1xyXG4gICAgICByZXR1cm4gYy5zdWJzdHJpbmcobmFtZS5sZW5ndGgsIGMubGVuZ3RoKTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIFwiXCI7XHJcbn07XHJcblxyXG5cclxuLyogMDEuIEhhbmRsZSBIZWFkZXIgTW9iaWxlIE5hdlxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhhbmRsZUhlYWRlck1vYmlsZU5hdiA9IGZ1bmN0aW9uKCkge1xyXG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS10b2dnbGU9XCJoZWFkZXItbW9iaWxlLW5hdlwiXScsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcclxuXHRcdCQoJy5oZWFkZXIgLmhlYWRlci1uYXYnKS5zbGlkZVRvZ2dsZSgpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuXHJcbi8qIDAyLiBIYW5kbGUgVGhlbWUgUGFuZWxcclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnZhciBoYW5kbGVUaGVtZVBhbmVsID0gZnVuY3Rpb24oKSB7XHJcblx0Ly8gVGhlbWUgUGFuZWwgLSBUb2dnbGUgLyBEaXNtaXNzXHJcblx0dmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1snKyBhcHAudGhlbWVQYW5lbC50b2dnbGVBdHRyICsnXScpO1xyXG5cdGlmIChlbG0pIHtcclxuXHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHZhciB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MpO1xyXG5cdFx0XHR2YXIgdGFyZ2V0RXhwYW5kID0gKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYXBwLnRoZW1lUGFuZWwuYWN0aXZlQ2xhc3MpKSA/IGZhbHNlIDogdHJ1ZTtcclxuXHRcdFx0XHJcblx0XHRcdHRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKGFwcC50aGVtZVBhbmVsLmFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0c2V0Q29va2llKGFwcC50aGVtZVBhbmVsLmNvb2tpZU5hbWUsIHRhcmdldEV4cGFuZCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8vIFRoZW1lIFBhbmVsIC0gVGhlbWUgU2VsZWN0b3JcclxuXHR2YXIgZWxtcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZS50b2dnbGVBdHRyICsnXScpKTtcclxuXHRpZiAoZWxtcykge1xyXG5cdFx0ZWxtcy5tYXAoZnVuY3Rpb24oZWxtKSB7XHJcblx0XHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dmFyIHRhcmdldFRoZW1lQ2xhc3MgPSB0aGlzLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZS5jbGFzc0F0dHIpO1xyXG5cdFx0XHRcdGZvciAodmFyIHggPSAwOyB4IDwgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QubGVuZ3RoOyB4KyspIHtcclxuXHRcdFx0XHRcdHZhciB0YXJnZXRDbGFzcyA9IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0W3hdO1xyXG5cdFx0XHRcdFx0aWYgKHRhcmdldENsYXNzLnNlYXJjaCgndGhlbWUtJykgPiAtMSkge1xyXG5cdFx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0Q2xhc3MpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAodGFyZ2V0VGhlbWVDbGFzcykge1xyXG5cdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKHRhcmdldFRoZW1lQ2xhc3MpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdFx0dmFyIHRvZ2dsZXJzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MgKycgWycrIGFwcC50aGVtZVBhbmVsLnRoZW1lLnRvZ2dsZUF0dHIgKyddJykpO1xyXG5cdFx0XHRcdHRvZ2dsZXJzLm1hcChmdW5jdGlvbih0b2dnbGVyKSB7XHJcblx0XHRcdFx0XHRpZiAodG9nZ2xlciAhPSBlbG0pIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlci5jbG9zZXN0KCcuJysgYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0SXRlbUNMYXNzKS5jbGFzc0xpc3QucmVtb3ZlKGFwcC50aGVtZVBhbmVsLnRoZW1lLmFjdGl2ZUNsYXNzKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZXIuY2xvc2VzdCgnLicrIGFwcC50aGVtZVBhbmVsLnRoZW1lTGlzdEl0ZW1DTGFzcykuY2xhc3NMaXN0LmFkZChhcHAudGhlbWVQYW5lbC50aGVtZS5hY3RpdmVDbGFzcyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0c2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lLmNvb2tpZU5hbWUsIHRhcmdldFRoZW1lQ2xhc3MpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblx0XHJcblx0XHJcblx0Ly8gVGhlbWUgUGFuZWwgLSBEYXJrIE1vZGVcclxuXHR2YXIgZWxtcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZURhcmtNb2RlLnRvZ2dsZUF0dHIgKyddJykpO1xyXG5cdGVsbXMubWFwKGZ1bmN0aW9uKGVsbSkge1xyXG5cdFx0ZWxtLm9uY2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICh0aGlzLmNoZWNrZWQpIHtcclxuXHRcdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuc2V0QXR0cmlidXRlKGFwcC5kYXJrTW9kZS5hdHRyLCBhcHAuZGFya01vZGUudmFsdWUpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5yZW1vdmVBdHRyaWJ1dGUoYXBwLmRhcmtNb2RlLmF0dHIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdEFwcC5pbml0VmFyaWFibGUoKTtcclxuXHRcdFx0c2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lRGFya01vZGUuY29va2llTmFtZSwgKHRoaXMuY2hlY2tlZCkgPyBhcHAudGhlbWVQYW5lbC50aGVtZURhcmtNb2RlLmNsYXNzIDogJycpO1xyXG5cdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChhcHAuZGFya01vZGUuZXZlbnROYW1lKSk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0XHJcblx0XHJcblx0aWYgKGdldENvb2tpZShhcHAudGhlbWVQYW5lbC5jb29raWVOYW1lKSAmJiBnZXRDb29raWUoYXBwLnRoZW1lUGFuZWwuY29va2llTmFtZSkgPT0gJ3RydWUnKSB7XHJcblx0XHR2YXIgZWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50b2dnbGVBdHRyICsnXScpO1xyXG5cdFx0aWYgKGVsbSkge1xyXG5cdFx0XHRlbG0uY2xpY2soKTtcclxuXHRcdH1cclxuXHR9XHJcblx0aWYgKGdldENvb2tpZShhcHAudGhlbWVQYW5lbC50aGVtZS5jb29raWVOYW1lKSkge1xyXG5cdFx0dmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyArJyBbJysgYXBwLnRoZW1lUGFuZWwudGhlbWUudG9nZ2xlQXR0ciArJ11bJysgYXBwLnRoZW1lUGFuZWwudGhlbWUuY2xhc3NBdHRyICsnPVwiJysgZ2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lLmNvb2tpZU5hbWUpICsnXCJdJyk7XHJcblx0XHRpZiAoZWxtKSB7XHJcblx0XHRcdGVsbS5jbGljaygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRpZiAoZ2V0Q29va2llKGFwcC50aGVtZVBhbmVsLnRoZW1lRGFya01vZGUuY29va2llTmFtZSkpIHtcclxuXHRcdHZhciBlbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MgKycgWycrIGFwcC50aGVtZVBhbmVsLnRoZW1lRGFya01vZGUudG9nZ2xlQXR0ciArJ10nKTtcclxuXHRcdGlmIChlbG0pIHtcclxuXHRcdFx0ZWxtLmNoZWNrZWQgPSB0cnVlO1xyXG5cdFx0XHRlbG0ub25jaGFuZ2UoKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyogMDMuIEhhbmRsZSBUb29sdGlwIEFjdGl2YXRpb25cclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnZhciBoYW5kbGVUb29sdGlwQWN0aXZhdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG5cdGlmICgkKCdbZGF0YS1icy10b2dnbGU9dG9vbHRpcF0nKS5sZW5ndGggIT09IDApIHtcclxuXHRcdCQoJ1tkYXRhLWJzLXRvZ2dsZT10b29sdGlwXScpLnRvb2x0aXAoKTtcclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyogMDQuIEhhbmRsZSBHZXQgQ3NzIFZhcmlhYmxlXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlQ3NzVmFyaWFibGUgPSBmdW5jdGlvbigpIHtcclxuXHR2YXIgcm9vdFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KTtcclxuXHRcclxuXHQvLyBmb250XHJcblx0aWYgKGFwcC52YXJpYWJsZUZvbnRMaXN0ICYmIGFwcC52YXJpYWJsZVByZWZpeCkge1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAoYXBwLnZhcmlhYmxlRm9udExpc3QpLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGFwcC5mb250W2FwcC52YXJpYWJsZUZvbnRMaXN0W2ldLnJlcGxhY2UoLy0oW2EtenwwLTldKS9nLCAobWF0Y2gsIGxldHRlcikgPT4gbGV0dGVyLnRvVXBwZXJDYXNlKCkpXSA9IHJvb3RTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLScrIGFwcC52YXJpYWJsZVByZWZpeCArIGFwcC52YXJpYWJsZUZvbnRMaXN0W2ldKS50cmltKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8vIGNvbG9yXHJcblx0aWYgKGFwcC52YXJpYWJsZUNvbG9yTGlzdCAmJiBhcHAudmFyaWFibGVQcmVmaXgpIHtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgKGFwcC52YXJpYWJsZUNvbG9yTGlzdCkubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0YXBwLmNvbG9yW2FwcC52YXJpYWJsZUNvbG9yTGlzdFtpXS5yZXBsYWNlKC8tKFthLXp8MC05XSkvZywgKG1hdGNoLCBsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKV0gPSByb290U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS0nKyBhcHAudmFyaWFibGVQcmVmaXggKyBhcHAudmFyaWFibGVDb2xvckxpc3RbaV0pLnRyaW0oKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxuLyogQXBwbGljYXRpb24gQ29udHJvbGxlclxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIEFwcCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly9tYWluIGZ1bmN0aW9uXHJcblx0XHRpbml0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGhhbmRsZUhlYWRlck1vYmlsZU5hdigpO1xyXG5cdFx0XHRoYW5kbGVUaGVtZVBhbmVsKClcclxuXHRcdFx0aGFuZGxlVG9vbHRpcEFjdGl2YXRpb24oKTtcclxuXHRcdFx0XHJcblx0XHRcdHRoaXMuaW5pdFZhcmlhYmxlKCk7XHJcblx0XHR9LFxyXG5cdFx0aW5pdFZhcmlhYmxlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aGFuZGxlQ3NzVmFyaWFibGUoKTtcclxuXHRcdH1cclxuICB9O1xyXG59KCk7XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuXHRBcHAuaW5pdCgpO1xyXG59KTsiXX0=
